(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8974],{3598:(e,t,s)=>{"use strict";s.d(t,{Ay:()=>u,PP:()=>l,ji:()=>i});var o=s(7780),n=s(2115),r=s(9373),a=s(5695);function u(){let{data:e}=(0,r.I)({queryKey:["userinfo"],queryFn:async()=>{let e=await (0,o.gL)({});return e?(console.log("mine result",e),e):{message:{firstname:"",lastname:"",phone:"",email:""}}}}),{data:t}=(0,r.I)({queryKey:["accountInfo"],queryFn:async()=>{let e=await (0,o.im)({});return(console.log("mine result",e),e)?e:{account:{accountBalance:0}}}});return console.log("userAccount data is",e),{userAccount:t,userInfo:e}}let l=()=>{let[e,t]=(0,n.useState)(0),s=(0,a.useRouter)(),o=(0,n.useCallback)(async()=>{try{let e=await fetch("".concat("http://localhost:60000","/api/user/logout"),{method:"POST",headers:{"Content-Type":"application/json"}});if(!e.ok)throw Error("Sorry, an error occurred");let s=await e.json();console.log("This is the response",s),(null==s?void 0:s.statusCode)&&t(s.statusCode)}catch(e){console.error("This is the error",e)}},[]);return(0,n.useEffect)(()=>{e&&s.push("/")},[e,s]),{Logout:o}},i=e=>{let t=(0,a.useRouter)(),[s,o]=(0,n.useState)("dummy message"),[r,u]=(0,n.useState)(!1);return{Verify:async()=>{if(console.log(Object.values(e)),""===Object.values(e)[0]){o("Bank Pin fields cannot be empty or invalid"),u(!0);return}try{o("");let s=await fetch("".concat("http://localhost:60000","/api/pin/verify-bank-pin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),n=await s.json();if(!s.ok){if(console.log(n),401===n.status)return void t.push("/");u(!0),o(n.message);return}if(console.log("This is the response",n),n){o(n.status),u(!0);return}}catch(e){console.error("This is the error",e),o(e.message),u(!0)}},message:s,setMessage:o,visible:r,setVisible:u}}},7344:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var o=s(5155),n=s(8347),r=s(5695),a=s(8447),u=s(2115);let l=e=>{let{children:t}=e,s=(0,r.useRouter)(),n=(0,r.usePathname)(),{data:l,isLoading:i,isError:c}=(0,a.w)();return(console.log("router path name",n),(0,u.useEffect)(()=>{if(console.log("Auth Status :",l,c,i),!i&&(null==l?void 0:l.userInfo)){let{isAdmin:e}=null==l?void 0:l.userInfo.message;e?s.push("/admin/dashboard"):s.push("client/dashboard"),console.log("userInfo info is",null==l?void 0:l.userInfo)}},[null==l?void 0:l.userInfo]),i)?(0,o.jsx)("div",{className:"d-flex justify-content-center align-items-center h-100",children:(0,o.jsx)("div",{id:"preloader",children:(0,o.jsx)("div",{"data-loader":"dual-ring"})})}):(null==l?void 0:l.userInfo)?null:t};function i(){return(0,o.jsx)(l,{children:(0,o.jsx)(n.default,{})})}},7658:(e,t,s)=>{Promise.resolve().then(s.bind(s,7344))},8447:(e,t,s)=>{"use strict";s.d(t,{w:()=>r});var o=s(3598),n=s(9373);let r=()=>{let{userAccount:e,userInfo:t}=(0,o.Ay)();return console.log("userAccount info hooks",t),(0,n.I)({queryKey:["authStatus"],queryFn:async()=>{if(!e)throw Error("Not authenticated");return{userInfo:t}},staleTime:0,refetchOnWindowFocus:!1})}}},e=>{var t=t=>e(e.s=t);e.O(0,[4766,8333,7354,1849,7780,8347,8441,1684,7358],()=>t(7658)),_N_E=e.O()}]);